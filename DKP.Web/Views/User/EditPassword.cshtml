<script>
    $(function () {
        $("form").validate({
            submitHandler: function (form) {
                $(form).find("button[type=submit]").attr("disabled", "disabled");
                $.ajax({
                    url: $(form).attr("action"),
                    dataType: 'json',
                    type: 'post',
                    data: $(form).serialize(),
                    error: function () {
                        window.parent.showMsg("error", "服务器超时！");
                        $(form).find("button[type=submit]").removeAttr("disabled");
                    },
                    success: function (data) {
                        if (data.code == 200) {
                            window.parent.showMsg("success", data.msg);
                            setTimeout("window.location.reload()", 2000)
                        }
                        else {
                            $(form).find("button[type=submit]").removeAttr("disabled");
                            window.parent.showMsg("error", data.msg);
                        }
                    }
                });
            }
        });
    });
</script>
<form action="@Url.Action("EditPassword","User",new { id = ViewBag.Id})" class="form-horizontal">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h6 class="modal-title">修改密码</h6>
    </div>
    <div class="modal-body">
        <div class="form-group">
            @FormHelpers.Text("旧密码", "OldPassword",valid: "required", inputSize: "5",type: "password")
        </div>
        <div class="form-group">
            @FormHelpers.Text("新密码", "NewPassword",valid: "required", inputSize: "5", type: "password")
        </div>
        <div class="form-group">
            @FormHelpers.Text("确认密码", "NewPassword2",valid: "required", inputSize: "5", type: "password")
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
        <button type="submit" class="btn btn-primary">保存</button>
    </div>
</form>