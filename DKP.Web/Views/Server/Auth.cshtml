@{
    Layout = "~/Views/Shared/_MainLayout.cshtml";
}
@section Bottom{ 
    <script>
        $(function () {
            $("form").validate({
                submitHandler: function (form) {
                    $(form).find("button[type=submit]").attr("disabled", "disabled");
                    $.ajax({
                        url: $(form).attr("action"),
                        dataType: 'json',
                        type: 'post',
                        data: $(form).serialize(),
                        error: function () {
                            window.parent.showMsg("error", "服务器超时！");
                            $(form).find("button[type=submit]").removeAttr("disabled");
                        },
                        success: function (data) {
                            if (data.code == 200) {
                                window.parent.showMsg("success",data.msg);
                                window.location.reload();
                            }
                            else {
                                $(form).find("button[type=submit]").removeAttr("disabled");
                                window.parent.showMsg("error", data.msg);
                            }
                        }
                    });
                }
            });

            $('.dtp').datetimepicker({
                language: "zh-CN",
                orientation: "top",
                todayBtn: true,
                autoclose: true
            });
        });
        $(".allcheck").click(function () {
            if ($(":checkbox:eq(0)").attr("checked") != "checked") {
                $(":checkbox").removeAttr("checked");
                $(":checkbox").siblings("label").click();
                $(":checkbox").attr("checked", "checked");
            }
            else {
                $(":checkbox").removeAttr("checked");
            }
        });
    </script>
}

<div class="wrapper wrapper-content animated fadeInRight">
    <div class="col-sm-5">
        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>服务器控制</h5>
            </div>
            <div class="ibox-content">
                <form action="@(Url.RouteUrl(ViewContext.RouteData.DataTokens["area"]))" class="form-horizontal">
                    <div class="form-group">
                        <label class="col-sm-3 control-label">权限选项</label>
                        <div class="col-sm-7">
                            <select class="form-control m-b" name="opt">
                                <option value="1">开放进入</option>
                                <option value="2">权限进入</option>
                                <option value="3">连接失败</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label">服务器</label>
                        <div class="col-sm-7">
                            @{
                                int i = 0;
                                foreach (var s in ViewBag.Servers)
                                {
                                    <div class="checkbox checkbox-@(s["color"]=="primary"?"success":s["color"])">
                                        <input id="checkbox@(i)" type="checkbox" name="serverName" value="@s["id"]">
                                        <label for="checkbox@(i)">
                                            @s["name"] (@s["ip"])
                                        </label>
                                        <span class="label label-@s["color"]" style="float:right;">@s["status"]</span>
                                    </div>
                                    i++;
                                }
                            }
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-10">
                            <button type="button" class="btn btn-success" style="float:right;margin-left:10px;">修改</button>
                            <button type="button" class="btn btn-default allcheck" style="float:right;">全选</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>